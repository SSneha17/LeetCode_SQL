| LeetCode#                                              | Title                                  | Query                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | Alternative Query                                                                                                                                                                                                                                                                                                                 |
|------------------------------------------------------------|----------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 184                                                        | Department Highest Salary              | SELECT d.name as Department, e.name as Employee, e.salary as Salary<br> FROM employee e<br> inner join department d on e.departmentId = d.id<br> inner join (select departmentId, max(salary) as sal from employee group by departmentId) ds on ds.departmentId = d.id<br> where e.salary = ds.sal                                                                                                                                                                    | SELECT d.name as Department, e.name as Employee, e.salary as Salary<br> FROM employee e<br> inner join department d on e.departmentId = d.id<br> where e.salary = (select max(salary) from employee where departmentId = d.id)                                                                                                    |
| 176                                                        | Second Highest Salary                  | SELECT <br> MAX(SALARY) as SecondHighestSalary from <br> Employee <br> WHERE SALARY < (SELECT MAX(SALARY) from Employee)                                                                                                                                                                                                                                                                                                                                              | SELECT TOP 1 SALARY FROM <br> (SELECT top 2 SALARY <br> FROM EMployee<br> order by SAlary DESC ) A<br> ORDER BY SALARY ASC                                                                                                                                                                                                        |
| 1251                                                       | Average Selling Price                  | SELECT p.product_id, COALESCE(ROUND(SUM(units*price)/SUM(units),2),0) as average_price<br> FROM Prices p <br> LEFT JOIN UnitsSold US ON p.product_id = us.product_id AND purchase_date >= start_date AND purchase_date <= end_date<br> GROUP BY p.product_id                                                                                                                                                                                                          |                                                                                                                                                                                                                                                                                                                                   |
| 1068                                                       | Product SAles Analysis I               | SELECT product_name, year, price<br> FROM Sales s<br> INNER JOIN Product p On s.product_id = p.product_id                                                                                                                                                                                                                                                                                                                                                             |                                                                                                                                                                                                                                                                                                                                   |
| 183                                                        | Customers who never order              | Select name as Customers from<br> customers where id NOT IN (select distinct customerId from Orders)                                                                                                                                                                                                                                                                                                                                                                  |                                                                                                                                                                                                                                                                                                                                   |
| 181                                                        | Employees earning more than manager    | Select e.name as Employee<br> from employee e<br> inner join employee m on e.managerId = m.id<br>  where e.salary > m.salary                                                                                                                                                                                                                                                                                                                                          |                                                                                                                                                                                                                                                                                                                                   |
| 197                                                        | Rising Temperatures                    | SELECT v.id <br> from Weather w, weather v<br> where v.recordDate = Dateadd(day,1, w.recordDate)and v.temperature > w.temperature                                                                                                                                                                                                                                                                                                                                     |                                                                                                                                                                                                                                                                                                                                   |
| 182                                                        | Duplicate Email                        | Select email <br> from Person<br> group by email<br> HAVING count(email) >1                                                                                                                                                                                                                                                                                                                                                                                           |                                                                                                                                                                                                                                                                                                                                   |
| 175                                                        | Combine Two tables                     | SELECT firstname, lastname, COALESCE(city, NULL) as City, COALESCE(state, NULL) as State<br> from person p <br> left join address a on a.personId = p.personId                                                                                                                                                                                                                                                                                                        |                                                                                                                                                                                                                                                                                                                                   |
| 1045                                                       | Customers who bought all products      | SELECT customer_id<br> FROM customer<br> group BY customer_Id<br> HAVING count(product_key) = (Select distinct count(product_key) from Product)                                                                                                                                                                                                                                                                                                                       |                                                                                                                                                                                                                                                                                                                                   |
| 178                                                        | Rank Scores                            | SELECT score, DENSE_RANK() OVER( order by score DESC ) as rank<br> from Scores                                                                                                                                                                                                                                                                                                                                                                                        |                                                                                                                                                                                                                                                                                                                                   |
| 196                                                        | Delete Duplicate emails                | DELETE P FROM (SELECT id, email, ROW_NUMBER() OVER (partition by email order by id ASC) as Row_Num<br> FROM Person ) P<br> WHERE P.Row_Num > 1                                                                                                                                                                                                                                                                                                                        |                                                                                                                                                                                                                                                                                                                                   |
| 177                                                        | Nth Highest Salary                     | CREATE FUNCTION getNthHighestSalary(@N INT) RETURNS INT AS<br> BEGIN<br>  RETURN (<br>  /* Write your T-SQL query statement below. */<br>  SELECT Salary FROM ( Select Salary, RANK() OVER (order by salary DESC) as rnk FROM Employee ) E WHERE Rnk = @N<br>  );<br> END                                                                                                                                                                                             |                                                                                                                                                                                                                                                                                                                                   |
| 586                                                        | Customer with largest number of Orders | SELECT TOP 1 customer_number FROM (SelecT customer_number, MAX(customer_number) as orders<br> FrOM Orders<br> Group BY customer_number<br> ) A<br> ORDER BY orders DESC                                                                                                                                                                                                                                                                                               |                                                                                                                                                                                                                                                                                                                                   |
| 577                                                        | Employee Bonus                         | Select e.name as name, bonus<br> from Employee e<br> left join Bonus b on e.empId = b.empId<br> WHERE bonus IS NULL OR bonus < 1000                                                                                                                                                                                                                                                                                                                                   |                                                                                                                                                                                                                                                                                                                                   |
| 1965                                                       | Employees with missing Information     | SELECT CASE WHEN e.employee_id IS NULL THEN s.employee_id ELSE e.employee_id END as employee_id<br> FROM Employees e <br> FULL JOIN Salaries s ON e.employee_id = s.employee_id<br> WHERE name is NUlL or salary is null<br> ORDER By e.employee_id                                                                                                                                                                                                                   |                                                                                                                                                                                                                                                                                                                                   |
| 550                                                        | Game Play Analysis-IV                  | DECLARE @count int<br> DECLARE @players int<br> SELECT @count = count(DISTINCT player_id) from Activity<br> <br> SElect @players = count(P.player_id)<br> FROM<br> (<br> SELECT a.player_Id,DATEDIFF(day,a.event_date, b.event_date) as diff<br> FROM Activity a<br> inner join Activity b on a.player_id = b.player_id AND b.event_date > a.event_date<br> ) P<br> WHERE diff = 1<br> <br> SELECT round(cast(@players as float)/cast(@count as float),2) as fraction | SELECT ROUND(count(DISTINCT p.player_id)*1.00/ (SELECT COUNT(DISTINCT player_id) FROM Activity)*1.00, 2) as fraction<br> FROM(<br> SELECT player_id,event_date, DATEDIFF(day, event_date, lead(event_date) OVER(partition by player_id order by event_date)) as diff<br> FROM Activity ) P<br> WHERE p.diff = 1                   |
| 534                                                        | Game Play Analysis III                 | select player_id, event_date, SUM(games_played) OVER (partition by player_id order by event_date) as games_played<br> FROM Activity                                                                                                                                                                                                                                                                                                                                   | select a. player_id, a. event_date, SUM(b.games_played) as games_played<br> FROM Activity a<br> left join Activity b ON a.player_id = b.player_id<br> WHERE a.event_date >= b.event_date<br> group by a.player_id, a.event_date                                                                                                   |
| 180                                                        | Consecutive numbers                    | Select num as ConsecutiveNums<br> from (<br> select distinct a.num, count(a.num) over (partition by a.num order by a.id) as C <br> from Logs a<br> inner join Logs b on a.num = b.num and abs(a.id-b.id) =1<br> group by a.num, a.id<br> ) L <br> WHERE C > 2                                                                                                                                                                                                         | Select num as ConsecutiveNums<br> from (<br> select id,num, lead(num) over (order by id) as next, lag(num) over (order by id) as prev<br> from logs<br> ) L<br> WHERE L.num = l.next OR l.num = l.prev<br> group by l.num<br> HAVINg count(num) > 2                                                                               |
| 626                                                        | Exchange Seats                         | Select id, CASE WHEN id % 2 = 0 THEN prev ELSE COALESCE(next, student) END as student<br> FROM (<br> SELECT id,student,LEAD(student) OVER(order by id) as next, lag(student) over (order by id) as prev<br> FROM Seat<br> ) S                                                                                                                                                                                                                                         | /* Write your T-SQL query statement below */<br> <br> Select s.id, (select student from Seat where id = s.id-1) as student<br> from Seat s<br> where s.id % 2 = 0<br> union<br> Select s1.id, COALESCE((select student from Seat where id = s1.id+1),student) as student<br> from Seat s1<br> where s1.id % 2 = 1<br> Order by id |
| https://leetcode.com/problems/consecutive-available-seats/ | Consecutive Available Seats            | SELECT distinct c1.seat_id<br> FROM cinema c1 <br> JOIN cinema c2 ON c1.free = 1 and c2.free = 1 AND <br> ORDER BY c1.seat_id;                                                                                                                                                                                                                                                                                                                                        |                                                                                                                                                                                                                                                                                                                                   |
| 3140                                                       | Consecutive Available Seats II         | Select top 1 num, min(id), max(id), MAX(d) as C<br> FROM(<br> select distinct a.num, a.id, count(a.num) over (partition by a.num order by a.id) as d<br> from Logs a<br> inner join Logs b on a.num = b.num and abs(a.id-b.id) =1<br> group by a.num, a.id<br> ) L<br> GROUP BY num<br> order by C DESC                                                                                                                                                               |                                                                                                                                                                                                                                                                                                                                   |
| 1084                                                       | Sales Analysis III                     | Select p.product_id, product_name<br> from sales s<br> inner join product p on s.product_id = p.product_id<br> WHERE sale_date BETWEEN '2019-01-01' AND '2019-03-31'<br> AND p.product_id NOT IN (Select product_id from Sales where sale_date < '2019-01-01' OR sale_date > '2019-03-31')                                                                                                                                                                            |                                                                                                                                                                                                                                                                                                                                   |
| 1083                                                       | Sales Analysis II                      | Select buyer_id<br> from sales <br> where product_id = 1<br> AND buyer_id NOT IN <br> (Select buyer_id from sales where product_id = 3)                                                                                                                                                                                                                                                                                                                               |                                                                                                                                                                                                                                                                                                                                   |
| 1757                                                       | Recyclable and Low Fat Product(s)      | SELECT product_id FROM products where low_fats='Y' AND recyclable='Y'                                                                                                                                                                                                                                                                                                                                                                                                 |                                                                                                                                                                                                                                                                                                                                   |
